"use strict";(self.webpackChunkangular_client=self.webpackChunkangular_client||[]).push([[566],{4566:(ua,vn,f)=>{f.r(vn),f.d(vn,{default:()=>je});var i=f(4650),E=f(9751),_n=f(2843),At=f(1135),We=f(8421),ci=f(5577),di=f(1144),R=f(576),yn=f(3268);const hi=["addListener","removeListener"],fi=["addEventListener","removeEventListener"],pi=["on","off"];function ce(t,e,n,r){if((0,R.m)(n)&&(r=n,n=void 0),r)return ce(t,e,n).pipe((0,yn.Z)(r));const[o,s]=function vi(t){return(0,R.m)(t.addEventListener)&&(0,R.m)(t.removeEventListener)}(t)?fi.map(a=>l=>t[a](e,l,n)):function gi(t){return(0,R.m)(t.addListener)&&(0,R.m)(t.removeListener)}(t)?hi.map(Cn(t,e)):function mi(t){return(0,R.m)(t.on)&&(0,R.m)(t.off)}(t)?pi.map(Cn(t,e)):[];if(!o&&(0,di.z)(t))return(0,ci.z)(a=>ce(a,e,n))((0,We.Xf)(t));if(!o)throw new TypeError("Invalid event target");return new E.y(a=>{const l=(...u)=>a.next(1<u.length?u:u[0]);return o(l),()=>s(l)})}function Cn(t,e){return n=>r=>t[n](e,r)}var de=f(7579);const Vn={now:()=>(Vn.delegate||Date).now(),delegate:void 0};class he extends de.x{constructor(e=1/0,n=1/0,r=Vn){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){const{isStopped:n,_buffer:r,_infiniteTimeWindow:o,_timestampProvider:s,_windowTime:a}=this;n||(r.push(e),!o&&r.push(s.now()+a)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:o}=this,s=o.slice();for(let a=0;a<s.length&&!e.closed;a+=r?1:2)e.next(s[a]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){const{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:o}=this,s=(o?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!o){const a=n.now();let l=0;for(let u=1;u<r.length&&r[u]<=a;u+=2)l=u;l&&r.splice(0,l+1)}}}var ye=f(9300),F=f(3900),_i=f(9718),W=f(8505),bn=f(262),C=f(4004),yi=f(5698),wn=f(3099);function An(t,e,n){let r,o=!1;return t&&"object"==typeof t?({bufferSize:r=1/0,windowTime:e=1/0,refCount:o=!1,scheduler:n}=t):r=t??1/0,(0,wn.B)({connector:()=>new he(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:o})}var Ce=f(4482),ne=f(5403),ze=f(5032);function Ze(t){return(0,Ce.e)((e,n)=>{(0,We.Xf)(t).subscribe((0,ne.x)(n,()=>n.complete(),ze.Z)),!n.closed&&e.subscribe(n)})}var Mt=f(4671);function Dt(){return(0,F.w)(Mt.y)}var Mn=f(8675);function Et(t,e){const n=t.length;t.push(e),function Ci(t,e,n){let r=n;for(;;){const o=r-1>>>1,s=t[o];if(!(void 0!==s&&Je(s,e)>0))return;t[o]=e,t[r]=s,r=o}}(t,e,n)}function O(t){const e=t[0];return void 0===e?null:e}function Ye(t){const e=t[0];if(void 0!==e){const n=t.pop();return n!==e&&(t[0]=n,function Vi(t,e,n){let r=n;const o=t.length;for(;r<o;){const s=2*(r+1)-1,a=t[s],l=s+1,u=t[l];if(void 0!==a&&Je(a,e)<0)void 0!==u&&Je(u,a)<0?(t[r]=u,t[l]=e,r=l):(t[r]=a,t[s]=e,r=s);else{if(!(void 0!==u&&Je(u,e)<0))return;t[r]=u,t[l]=e,r=l}}}(t,n,0)),e}return null}function Je(t,e){const n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}let z;if("object"==typeof i.dqk.performance&&"function"==typeof i.dqk.performance.now){const t=i.dqk.performance;z=()=>t.now()}else{const t=Date,e=t.now();z=()=>t.now()-e}const I=[],Z=[];let xi=1,g=null,b=3,Ke=!1,re=!1,Ve=!1;const En=i.dqk.setTimeout,Si=i.dqk.clearTimeout,xn=i.dqk.setImmediate,Sn=i.dqk.MessageChannel,Fi=(typeof i.dqk.navigator<"u"&&void 0!==i.dqk.navigator.scheduling&&void 0!==i.dqk.navigator.scheduling.isInputPending&&i.dqk.navigator.scheduling.isInputPending.bind(i.dqk.navigator.scheduling),{run:t=>t()});function xt(t){let e=O(Z);for(;null!==e;){if(null===e.callback)Ye(Z);else{if(!(e.startTime<=t))return;Ye(Z),e.sortIndex=e.expirationTime,Et(I,e)}e=O(Z)}}function St(t){if(Ve=!1,xt(t),!re)if(null!==O(I))re=!0,Tt(Ft);else{const e=O(Z);null!==e&&kt(St,e.startTime-t)}}function Ft(t,e){re=!1,Ve&&(Ve=!1,In()),Ke=!0;const n=b;try{return Fn(t,e)}finally{g=null,b=n,Ke=!1}}function Fn(t,e,n){let r=e;n?g=n:(xt(r),g=O(I));let o=!1;const s=()=>g&&g.expirationTime>r&&(!t||function Ni(){return!(!It&&z()-On<be)}());if(!s()){const a=g.ngZone||Fi;a.run(()=>{for(;null!==g&&!o&&!s();){const l=g.callback;if("function"==typeof l){g.callback=null,b=g.priorityLevel;const p=l(g.expirationTime<=r);r=z(),"function"==typeof p?g.callback=p:g===O(I)&&Ye(I),xt(r)}else Ye(I);g=O(I),o=null!=g?.ngZone&&g.ngZone!==a}})}if(g=g??O(I),r=z(),o||g&&!s())return Fn(t,r,g);if(null!==g)return!0;{const a=O(Z);return null!==a&&kt(St,a.startTime-r),!1}}let Xe=!1,Qe=null,Ot=-1,be=16,It=!1,On=-1;const Nt=()=>{if(null!==Qe){const t=z();On=t;const e=!0;let n=!0;try{n=Qe(e,t)}finally{n?we():(Xe=!1,Qe=null)}}else Xe=!1;It=!1};let we;if("function"==typeof xn)we=()=>{xn(Nt)};else if(typeof Sn<"u"){const t=new Sn,e=t.port2;t.port1.onmessage=Nt,we=()=>{e.postMessage(null)}}else we=()=>{En(Nt,0)};function Tt(t){Qe=t,Xe||(Xe=!0,we())}function kt(t,e){Ot=En(()=>{t(z())},e)}function In(){Si(Ot),Ot=-1}var fe=f(727);const ie=function Gi(){return{remove:function t(r){const o=Ae.getProps(r).numCoalescingSubscribers-1;Ae.setProps(r,{numCoalescingSubscribers:o>=0?o:0})},add:function e(r){const o=Ae.getProps(r).numCoalescingSubscribers+1;Ae.setProps(r,{numCoalescingSubscribers:o})},isCoalescing:function n(r){return Ae.getProps(r).numCoalescingSubscribers>0}}}(),Ae=function Pi(t){const e=new WeakMap;return{getProps:n,setProps:function r(o,s){const a=n(o);return Object.entries(s).forEach(([l,u])=>{a[l]=u}),e.set(o,a),a}};function n(o){const s=t(o),a=e.get(o);let l;return void 0!==a?l=a:(l={},Object.entries(s).forEach(([u,p])=>{l[u]=function ki(t,e){return null!=t[e]}(o,u)?o[u]:p}),e.set(o,l)),l}}(t=>({numCoalescingSubscribers:0}));var Pt=f(2076);function N(t,e){return"string"==typeof t&&(e=t,t=i.dqk),t["__zone_symbol__"+e]||t[e]}const Ui=N("Promise").resolve();function Nn(t){return!!t&&(t instanceof E.y||(0,R.m)(t.lift)&&(0,R.m)(t.subscribe))}(0,Pt.D)(Ui);var pe=f(9646);function et(t,e=Mt.y){return t=t??Li,(0,Ce.e)((n,r)=>{let o,s=!0;n.subscribe((0,ne.x)(r,a=>{const l=e(a);(s||!t(o,l))&&(s=!1,o=l,r.next(a))}))})}function Li(t,e){return t===e}function Tn(t){return Nn(t)?t:(0,pe.of)(t)}function qi(t){return t=t||Dt(),e=>e.pipe(function ji(){return t=>(0,C.U)(Tn)(t)}(),et(),t,et())}function kn(t,e){const n=t?t():new de.x;return e=e||Dt(),{next(o){n.next(o)},values$:n.pipe(qi(e))}}function Me(t,e){const n=e.scope||{};return r=>r.pipe((0,ye.h)(()=>!ie.isCoalescing(n)),(0,F.w)(o=>new E.y(s=>{ie.add(n);const a=function Oi(t,e,n){const r=z();let o,s;if("object"==typeof n&&null!==n){const u=n.delay;o="number"==typeof u&&u>0?r+u:r}else o=r;switch(t){case 1:s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}const a=o+s,l={id:xi++,callback:e,priorityLevel:t,startTime:o,expirationTime:a,sortIndex:-1,ngZone:n?.ngZone||null};return o>r?(l.sortIndex=o,Et(Z,l),null===O(I)&&l===O(Z)&&(Ve?In():Ve=!0,kt(St,o-r))):(l.sortIndex=a,Et(I,l),!re&&!Ke&&(re=!0,Tt(Ft))),l}(e.priority,()=>{t(),ie.remove(n),s.next(o)},{delay:e.delay,ngZone:e.ngZone});return()=>{ie.remove(n),function Ii(t){t.callback=null}(a)}}).pipe((0,_i.h)(o))))}!function Ti(t){t<0||t>125||(be=t>0?Math.floor(1e3/t):5,be=Math.max(5,be-6))}(60);const Ki={immediate:{name:"immediate",work:t=>t.detectChanges(),behavior:({work:t,scope:e,ngZone:n})=>r=>r.pipe(Me(t,{ngZone:n,priority:1,scope:e}))},userBlocking:{name:"userBlocking",work:t=>t.detectChanges(),behavior:({work:t,scope:e,ngZone:n})=>r=>r.pipe(Me(t,{ngZone:n,priority:2,scope:e}))},normal:{name:"normal",work:t=>t.detectChanges(),behavior:({work:t,scope:e,ngZone:n})=>r=>r.pipe(Me(t,{ngZone:n,priority:3,scope:e}))},low:{name:"low",work:t=>t.detectChanges(),behavior:({work:t,scope:e,ngZone:n})=>r=>r.pipe(Me(t,{ngZone:n,priority:4,scope:e}))},idle:{name:"idle",work:t=>t.detectChanges(),behavior:({work:t,scope:e,ngZone:n})=>r=>r.pipe(Me(t,{ngZone:n,priority:5,scope:e}))}},Qi={name:"local",work:(t,e,n)=>{t.detectChanges()},behavior:({work:t,scope:e,ngZone:n})=>r=>r.pipe(function Ri(t,e){const n=e||{};return r=>new E.y(s=>{const a=new fe.w0;return a.add(r.subscribe(function o(s,a){let l,u;const p=()=>{l&&(ie.remove(n),ie.isCoalescing(n)||s.next(u))};return{complete:()=>{p(),s.complete()},error:h=>s.error(h),next:h=>{u=h,l||(ie.add(n),l=t.subscribe({error:d=>s.error(d),next:()=>{p(),l?.unsubscribe(),l=void 0},complete:()=>{p(),l=void 0}}),a.add(new fe.w0(()=>{p(),l?.unsubscribe(),l=void 0})))}}}(s,a))),a})}(new E.y(t=>{const e=N("requestAnimationFrame")(()=>{t.next(0),t.complete()});return()=>{N("cancelAnimationFrame")(e)}}),e),(0,W.b)(()=>n?n.run(()=>t()):t()))},Pn={name:"native",work:t=>t.markForCheck(),behavior:({work:t,ngZone:e})=>n=>n.pipe((0,W.b)(()=>e&&!i.R0b.isInAngularZone()?e.run(()=>t()):t()))},to={global:Object.assign(Object.assign({},Pn),{name:"global"}),native:Pn,noop:{name:"noop",work:()=>{},behavior:()=>t=>t},local:Qi},no=new i.OlP("rxa-render-strategies-config"),Gn={primaryStrategy:"normal",customStrategies:Object.assign(Object.assign({},to),Ki),patchZone:!0,parent:!0};function De(t,e,n,r={}){return new E.y(o=>{o.next(t)}).pipe(e.behavior({work:()=>n(t,e.work,r),scope:r.scope||{},ngZone:r.ngZone}),(0,bn.K)(o=>(0,_n._)(()=>[o,t])),(0,C.U)(()=>t),(0,yi.q)(1))}let Rn=(()=>{class t{constructor(n){this._strategies$=new At.X(void 0),this._primaryStrategy$=new At.X(void 0),this.primaryStrategy$=this._primaryStrategy$.asObservable(),this.strategies$=this._strategies$.asObservable(),this.strategyNames$=this.strategies$.pipe((0,C.U)(r=>Object.values(r).map(o=>o.name)),An({bufferSize:1,refCount:!0})),this._cfg=function ro(t){const e=t||{customStrategies:{}};return Object.assign(Object.assign(Object.assign({},Gn),e),{customStrategies:Object.assign(Object.assign({},e.customStrategies),Gn.customStrategies)})}(n),this._strategies$.next(this._cfg.customStrategies),this.primaryStrategy=this.config.primaryStrategy}get config(){return this._cfg}get strategies(){return this._strategies$.getValue()}get strategyNames(){return Object.values(this.strategies).map(n=>n.name)}get primaryStrategy(){return this._primaryStrategy$.getValue().name}set primaryStrategy(n){this._primaryStrategy$.next(this.strategies[n])}scheduleWith(n,r){const o=this.strategies[r?.strategy||this.primaryStrategy],s=r?.scope||{},a=Gt(n,r?.patchZone),l=r?.patchZone||void 0;return u=>u.pipe((0,F.w)(p=>De(p,o,h=>{a(h)},{scope:s,ngZone:l})))}schedule(n,r){const o=this.strategies[r?.strategy||this.primaryStrategy],s=r?.scope||{},a=Gt(n,r?.patchZone);let u;return De(null,o,()=>{u=a()},{scope:s,ngZone:r?.patchZone||void 0}).pipe((0,C.U)(()=>u))}scheduleCD(n,r){const o=this.strategies[r?.strategy||this.primaryStrategy],s=r?.scope||n,a=r?.abortCtrl||new AbortController,l=r?.patchZone||void 0,u=Gt(()=>{o.work(n,s),r?.afterCD&&r.afterCD()},r.patchZone);return De(null,o,()=>{u()},{scope:s,ngZone:l}).pipe(Ze(ce(a.signal,"abort"))).subscribe(),a}}return t.\u0275fac=function(n){return new(n||t)(i.LFG(no,8))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Gt(t,e){let n=t;return e&&(n=r=>e.run(()=>t(r))),n}function Bn(t,e){const n=kn(()=>new he(1),Dt());return{strategy$:n.values$.pipe((0,Mn.O)(t),io(e,t),(0,wn.B)()),next(r){n.next(r)}}}function io(t,e){return n=>n.pipe((0,C.U)(r=>r&&Object.keys(t).includes(r)?t[r]:t[e]))}var oo=f(7272),Un=f(515),Hn=f(6451),$n=f(7669);function Rt(...t){const e=(0,$n.jO)(t);return(0,Ce.e)((n,r)=>{const o=t.length,s=new Array(o);let a=t.map(()=>!1),l=!1;for(let u=0;u<o;u++)(0,We.Xf)(t[u]).subscribe((0,ne.x)(r,p=>{s[u]=p,!l&&!a[u]&&(a[u]=!0,(l=a.every(Mt.y))&&(a=null))},ze.Z));n.subscribe((0,ne.x)(r,u=>{if(l){const p=[u,...s];r.next(e?e(...p):p)}}))})}var tt=(()=>{return(t=tt||(tt={})).error="errorTpl",t.complete="completeTpl",t.suspense="suspenseTpl",tt;var t})();function co(t){const{renderSettings:e,notificationToTemplateName:n,templateSettings:r}=t,{defaultStrategyName:o,strategies:s,cdRef:a,patchZone:l,parent:u}=e,p=function qn(t){const e=t?n=>t.handleError(n):console.error;return{handleError:n=>{!function lo(t){return null!=t&&Array.isArray(t)&&2===t.length&&t[0]instanceof Error}(n)?e(n):(e(n[0]),console.error("additionalErrorContext",n[1]))}}}(e.errorHandler),h=l||void 0;let d;const m=Bn(o,s),_=function ao(t){const e=new Map,n=s=>e.get(s)||(0,pe.of)(void 0),r=s=>{let a;const l=n(s);return l&&l.subscribe(p=>a=p).unsubscribe(),a};return{add(s,a){(function o(s,a){if(!!(a&&!a.createEmbeddedView))throw new Error(`${s} must be a TemplateRef, but received ${typeof a}`)})(s,a),e.has(s)?e.get(s).next(a):e.set(s,new At.X(a))},get$:n,get:r,createEmbeddedView:(s,a)=>function Ln(t,e,n,r=0){const o=t.createEmbeddedView(e,n,r);return o.detectChanges(),o}(t,r(s),a)}}(r.viewContainerRef),ae=r.viewContainerRef,P=t.templateTrigger$||Un.E,wt=function uo(t){return{suspense:e=>{const n=e.value;return Object.assign({$implicit:n,suspense:!0,error:!1,complete:!1},t(n))},next:e=>{const n=e.value;return Object.assign({$implicit:n,suspense:!1,error:!1,complete:!1},t(n))},error:e=>{const n=e.value;return Object.assign({$implicit:n,complete:!1,error:e.error||!0,suspense:!1},t(n))},complete:e=>{const n=e.value;return Object.assign({$implicit:n,error:!1,complete:!0,suspense:!1},t(n))}}}(r.customContext||(()=>({})));return{addTemplateRef:(_e,ee)=>{_.add(_e,ee)},nextStrategy:m.next,render(_e){let ee,L={value:void 0,complete:!1,error:!1,kind:"suspense",hasValue:!1};return(0,Hn.T)(_e.pipe((0,W.b)(D=>L=D)),P.pipe((0,W.b)(D=>ee=D))).pipe((0,F.w)(()=>{const D=ee||L.kind;ee=void 0;const te=n[D](L.value,_);return _.get$(te).pipe((0,C.U)(V=>({template:V,templateName:te,notification:L,contextKind:D})))}),Rt(m.strategy$),(0,F.w)(([{template:D,templateName:qe,notification:te,contextKind:V},x])=>{const S=d!==D||!D,G=S&&u;return De(te.value,x,(y,j,q)=>{const le=wt[V](te);if(S)ae.length>0&&ae.clear(),D&&_.createEmbeddedView(qe,le);else if(D){const ue=ae.get(0);Object.keys(le).forEach(ui=>{ue.context[ui]=le[ui]}),j(ue,q.scope,te)}d=D},{ngZone:h}).pipe(function jn(t,e,n,r){return o=>o.pipe((0,F.w)(s=>n()?(0,oo.z)((0,pe.of)(s),De(t,e,(l,u,p)=>{u(t,p.scope)},{scope:t.context||t,ngZone:r}).pipe(function so(){return(0,Ce.e)((t,e)=>{t.subscribe((0,ne.x)(e,ze.Z))})}())):(0,pe.of)(s)))}(a,x,()=>G,h),(0,bn.K)(y=>(p.handleError(y),(0,pe.of)(y))))}))}}}const Y=new E.y(ze.Z);class H{constructor(e,n,r){this.kind=e,this.value=n,this.error=r,this.hasValue="N"===e}observe(e){return function po(t,e){var n,r,o;const{kind:s,value:a,error:l}=t;if("string"!=typeof s)throw new TypeError('Invalid notification, missing "kind"');"N"===s?null===(n=e.next)||void 0===n||n.call(e,a):"E"===s?null===(r=e.error)||void 0===r||r.call(e,l):null===(o=e.complete)||void 0===o||o.call(e)}(this,e)}do(e,n,r){const{kind:o,value:s,error:a}=this;return"N"===o?e?.(s):"E"===o?n?.(a):r?.()}accept(e,n,r){var o;return(0,R.m)(null===(o=e)||void 0===o?void 0:o.next)?this.observe(e):this.do(e,n,r)}toObservable(){const{kind:e,value:n,error:r}=this,o="N"===e?(0,pe.of)(n):"E"===e?(0,_n._)(()=>r):"C"===e?Un.E:0;if(!o)throw new TypeError(`Unexpected notification kind ${e}`);return o}static createNext(e){return new H("N",e)}static createError(e){return new H("E",void 0,e)}static createComplete(){return H.completeNotification}}function Yn(){const t=new he(1);let e=!1;const n=t.pipe(et(),(0,C.U)(o=>function Vo(t){var e;return"function"==typeof(null===(e=t)||void 0===e?void 0:e.then)||Nn(t)}(o)?function r(o){return new E.y(s=>{let a=!0;const l=(0,Pt.D)(o).subscribe({next:u=>{a=!1,s.next(u)},error:u=>{a=!1,s.error(u)},complete:()=>s.complete()});return e&&a&&s.next(void 0),()=>{l.unsubscribe()}})}(o):e||void 0!==o?(t=>Y.pipe((0,Mn.O)(t)))(o):Y),(0,F.w)(o=>o.pipe((0,W.b)(()=>e=!0),et(),function vo(){return t=>t.pipe(function go(){return(0,Ce.e)((t,e)=>{t.subscribe((0,ne.x)(e,n=>{e.next(H.createNext(n))},()=>{e.next(H.createComplete()),e.complete()},n=>{e.next(H.createError(n)),e.complete()}))})}(),(0,W.b)(({kind:e,error:n})=>{"E"===e&&console.error(n)}),(0,C.U)(({value:e,error:n,kind:r,hasValue:o})=>{const s=function _o(t){switch(t){case"C":return"complete";case"E":return"error";default:return"next"}}(r);return{value:e,hasValue:o,error:n,kind:s,complete:"complete"===s}}))}(),(0,C.U)((()=>{let t;return e=>("next"===e.kind&&(t=e.value),"next"===e.kind&&void 0===e.value?function mo(t){return{value:t,kind:"suspense",hasValue:!!t||!1,complete:!1,error:!1}}(void 0):(("error"===e.kind||"complete"===e.kind||"suspense"===e.kind)&&(e.value=t),e))})()))));return{next(o){t.next(o)},withInitialSuspense(o){e=e||o},values$:n}}H.completeNotification=new H("C");var bo=f(8189);const T=Object.assign(Object.assign({},tt),{then:"rxThen",else:"rxElse"});let Bt=(()=>{class t{constructor(n,r,o,s,a){this.strategyProvider=n,this.cdRef=r,this.ngZone=o,this.templateRef=s,this.viewContainerRef=a,this.subscription=new fe.w0,this.renderParent=this.strategyProvider.config.parent,this.patchZone=this.strategyProvider.config.patchZone,this.triggerHandler=new he(1),this.templateNotifier=Yn(),this.strategyHandler=kn(()=>new he(1),(0,bo.J)()),this.rendered$=new de.x}set strategy(n){this.strategyHandler.next(n)}set renderCallback(n){this._renderObserver=n}get thenTemplate(){return this.then?this.then:this.templateRef}ngOnInit(){var n,r,o,s;this.subscription.add((0,Hn.T)(this.contextTrigger||Y,(null===(n=this.nextTrigger)||void 0===n?void 0:n.pipe((0,C.U)(()=>"next")))||Y,(null===(r=this.suspenseTrigger)||void 0===r?void 0:r.pipe((0,C.U)(()=>"suspense")))||Y,(null===(o=this.completeTrigger)||void 0===o?void 0:o.pipe((0,C.U)(()=>"complete")))||Y,(null===(s=this.errorTrigger)||void 0===s?void 0:s.pipe((0,C.U)(()=>"error")))||Y).pipe((0,ye.h)(a=>!!a)).subscribe(a=>this.triggerHandler.next(a))),this.subscription.add(this.templateManager.render(this.templateNotifier.values$).subscribe(a=>{var l;this.rendered$.next(a),null===(l=this._renderObserver)||void 0===l||l.next(a)}))}ngOnChanges(n){this.templateManager||this._createTemplateManager(),n.then&&!n.then.firstChange&&this.templateManager.addTemplateRef(T.then,this.thenTemplate),n.else&&this.templateManager.addTemplateRef(T.else,this.else),n.complete&&this.templateManager.addTemplateRef(T.complete,this.complete),n.suspense&&(this.templateManager.addTemplateRef(T.suspense,this.suspense),this.templateNotifier.withInitialSuspense(!!this.suspense)),n.error&&this.templateManager.addTemplateRef(T.error,this.error),n.rxIf&&this.templateNotifier.next(this.rxIf)}ngOnDestroy(){this.subscription.unsubscribe()}_createTemplateManager(){const n=r=>r?T.then:this.else?T.else:void 0;this.templateManager=co({templateSettings:{viewContainerRef:this.viewContainerRef,customContext:r=>({rxIf:r})},renderSettings:{cdRef:this.cdRef,parent:wo(this.renderParent),patchZone:!!this.patchZone&&this.ngZone,defaultStrategyName:this.strategyProvider.primaryStrategy,strategies:this.strategyProvider.strategies},notificationToTemplateName:{suspense:r=>this.suspense?T.suspense:n(r),next:r=>n(r),error:r=>this.error?T.error:n(r),complete:r=>this.complete?T.complete:n(r)},templateTrigger$:this.triggerHandler}),this.templateManager.addTemplateRef(T.then,this.thenTemplate),this.templateManager.nextStrategy(this.strategyHandler.values$)}static ngTemplateContextGuard(n,r){return!0}}return t.\u0275fac=function(n){return new(n||t)(i.Y36(Rn),i.Y36(i.sBO),i.Y36(i.R0b),i.Y36(i.Rgc),i.Y36(i.s_b))},t.\u0275dir=i.lG2({type:t,selectors:[["","rxIf",""]],inputs:{rxIf:"rxIf",strategy:["rxIfStrategy","strategy"],else:["rxIfElse","else"],then:["rxIfThen","then"],suspense:["rxIfSuspense","suspense"],complete:["rxIfComplete","complete"],error:["rxIfError","error"],contextTrigger:["rxIfContextTrigger","contextTrigger"],nextTrigger:["rxIfNextTrigger","nextTrigger"],suspenseTrigger:["rxIfSuspenseTrigger","suspenseTrigger"],errorTrigger:["rxIfErrorTrigger","errorTrigger"],completeTrigger:["rxIfCompleteTrigger","completeTrigger"],renderParent:["rxIfParent","renderParent"],patchZone:["rxIfPatchZone","patchZone"],renderCallback:["rxIfRenderCallback","renderCallback"]},features:[i.TTD]}),t})();function wo(t){return null!=t&&"false"!=`${t}`}let Ut=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[]]}),t})(),Mo=(()=>{class t{constructor(n,r,o){this.strategyProvider=n,this.cdRef=r,this.ngZone=o,this.templateObserver=Yn(),this.templateValues$=this.templateObserver.values$.pipe(function Do(){return t=>t.pipe((0,ye.h)(e=>"suspense"===e.kind||"next"===e.kind))}(),An({bufferSize:1,refCount:!0})),this.strategyHandler=Bn(this.strategyProvider.primaryStrategy,this.strategyProvider.strategies)}transform(n,r,o){return this._renderCallback=o,r&&(function Eo(t){return null!=t&&(Ht.call(t,"strategy")||Ht.call(t,"renderCallback")||Ht.call(t,"patchZone"))}(r)?(this.strategyHandler.next(r.strategy),this._renderCallback=r.renderCallback,this.setPatchZone(r.patchZone)):this.strategyHandler.next(r)),this.templateObserver.next(n),this.subscription||(this.subscription=this.handleChangeDetection()),this.renderedValue}ngOnDestroy(){var n;null===(n=this.subscription)||void 0===n||n.unsubscribe()}setPatchZone(n){this.patchZone=!!(n??this.strategyProvider.config.patchZone)&&this.ngZone}handleChangeDetection(){const n=this.cdRef.context,r=new fe.w0,o=this.templateValues$.subscribe(({value:a})=>{this.renderedValue=a}),s=this.hasInitialValue(this.templateValues$).pipe((0,F.w)(a=>this.templateValues$.pipe(function Ao(t){return(0,ye.h)((e,n)=>t<=n)}(a?1:0),this.render(n),(0,W.b)(l=>{var u;null===(u=this._renderCallback)||void 0===u||u.next(l)})))).subscribe();return r.add(o),r.add(s),r}render(n){return r=>r.pipe(Rt(this.strategyHandler.strategy$),(0,F.w)(([o,s])=>this.strategyProvider.schedule(()=>(s.work(this.cdRef,n),o.value),{scope:n,strategy:s.name,patchZone:this.patchZone})))}hasInitialValue(n){return new E.y(r=>{let o=!1;n.subscribe(()=>{o=!0}).unsubscribe(),r.next(o),r.complete()})}}return t.\u0275fac=function(n){return new(n||t)(i.Y36(Rn,16),i.Y36(i.sBO,16),i.Y36(i.R0b,16))},t.\u0275pipe=i.Yjl({name:"push",type:t,pure:!1}),t})();const Ht=Object.prototype.hasOwnProperty;let xo=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})();var So=f(9645),Jn=f(6895),Fo=f(4742),Oo=f(1810);let Kn=(()=>{class t{constructor(n,r){this._renderer=n,this._elementRef=r,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return t.\u0275fac=function(n){return new(n||t)(i.Y36(i.Qsj),i.Y36(i.SBq))},t.\u0275dir=i.lG2({type:t}),t})(),oe=(()=>{class t extends Kn{}return t.\u0275fac=function(){let e;return function(r){return(e||(e=i.n5z(t)))(r||t)}}(),t.\u0275dir=i.lG2({type:t,features:[i.qOj]}),t})();const B=new i.OlP("NgValueAccessor"),To={provide:B,useExisting:(0,i.Gpc)(()=>Ee),multi:!0},Po=new i.OlP("CompositionEventMode");let Ee=(()=>{class t extends Kn{constructor(n,r,o){super(n,r),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function ko(){const t=(0,Jn.q)()?(0,Jn.q)().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return t.\u0275fac=function(n){return new(n||t)(i.Y36(i.Qsj),i.Y36(i.SBq),i.Y36(Po,8))},t.\u0275dir=i.lG2({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){1&n&&i.NdJ("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[i._Bn([To]),i.qOj]}),t})();const w=new i.OlP("NgValidators"),K=new i.OlP("NgAsyncValidators");function nr(t){return function J(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}(t.value)?{required:!0}:null}function nt(t){return null}function lr(t){return null!=t}function ur(t){return(0,i.QGY)(t)?(0,Pt.D)(t):t}function cr(t){let e={};return t.forEach(n=>{e=null!=n?{...e,...n}:e}),0===Object.keys(e).length?null:e}function dr(t,e){return e.map(n=>n(t))}function hr(t){return t.map(e=>function Bo(t){return!t.validate}(e)?e:n=>e.validate(n))}function $t(t){return null!=t?function fr(t){if(!t)return null;const e=t.filter(lr);return 0==e.length?null:function(n){return cr(dr(n,e))}}(hr(t)):null}function Lt(t){return null!=t?function pr(t){if(!t)return null;const e=t.filter(lr);return 0==e.length?null:function(n){return function Io(...t){const e=(0,$n.jO)(t),{args:n,keys:r}=(0,Fo.D)(t),o=new E.y(s=>{const{length:a}=n;if(!a)return void s.complete();const l=new Array(a);let u=a,p=a;for(let h=0;h<a;h++){let d=!1;(0,We.Xf)(n[h]).subscribe((0,ne.x)(s,m=>{d||(d=!0,p--),l[h]=m},()=>u--,void 0,()=>{(!u||!d)&&(p||s.next(r?(0,Oo.n)(r,l):l),s.complete())}))}});return e?o.pipe((0,yn.Z)(e)):o}(dr(n,e).map(ur)).pipe((0,C.U)(cr))}}(hr(t)):null}function gr(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function jt(t){return t?Array.isArray(t)?t:[t]:[]}function rt(t,e){return Array.isArray(t)?t.includes(e):t===e}function _r(t,e){const n=jt(e);return jt(t).forEach(o=>{rt(n,o)||n.push(o)}),n}function yr(t,e){return jt(e).filter(n=>!rt(t,n))}class Cr{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=$t(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Lt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,n){return!!this.control&&this.control.hasError(e,n)}getError(e,n){return this.control?this.control.getError(e,n):null}}class M extends Cr{get formDirective(){return null}get path(){return null}}class X extends Cr{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Vr{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let qt=(()=>{class t extends Vr{constructor(n){super(n)}}return t.\u0275fac=function(n){return new(n||t)(i.Y36(X,2))},t.\u0275dir=i.lG2({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){2&n&&i.ekj("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[i.qOj]}),t})(),Wt=(()=>{class t extends Vr{constructor(n){super(n)}}return t.\u0275fac=function(n){return new(n||t)(i.Y36(M,10))},t.\u0275dir=i.lG2({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,r){2&n&&i.ekj("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[i.qOj]}),t})();const xe="VALID",ot="INVALID",ge="PENDING",Se="DISABLED";function Jt(t){return(st(t)?t.validators:t)||null}function Kt(t,e){return(st(e)?e.asyncValidators:t)||null}function st(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class Mr{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===xe}get invalid(){return this.status===ot}get pending(){return this.status==ge}get disabled(){return this.status===Se}get enabled(){return this.status!==Se}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(_r(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(_r(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(yr(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(yr(e,this._rawAsyncValidators))}hasValidator(e){return rt(this._rawValidators,e)}hasAsyncValidator(e){return rt(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ge,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=Se,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=xe,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===xe||this.status===ge)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Se:xe}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ge,this._hasOwnPendingAsyncValidator=!0;const n=ur(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(!1!==n.emitEvent)}get(e){let n=e;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((r,o)=>r&&r._find(o),this)}getError(e,n){const r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new i.vpe,this.statusChanges=new i.vpe}_calculateStatus(){return this._allControlsDisabled()?Se:this.errors?ot:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ge)?ge:this._anyControlsHaveStatus(ot)?ot:xe}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){st(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function Wo(t){return Array.isArray(t)?$t(t):t||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function zo(t){return Array.isArray(t)?Lt(t):t||null}(this._rawAsyncValidators)}}class Xt extends Mr{constructor(e,n,r){super(Jt(n),Kt(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){(function Ar(t,e,n){t._forEachChild((r,o)=>{if(void 0===n[o])throw new i.vHH(1002,"")})})(this,0,e),Object.keys(e).forEach(r=>{(function wr(t,e,n){const r=t.controls;if(!(e?Object.keys(r):r).length)throw new i.vHH(1e3,"");if(!r[n])throw new i.vHH(1001,"")})(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){null!=e&&(Object.keys(e).forEach(r=>{const o=this.controls[r];o&&o.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,o)=>{r.reset(e[o],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>!!r._syncPendingControls()||n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{const r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(n,r,o)=>((r.enabled||this.disabled)&&(n[o]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((o,s)=>{r=n(r,o,s)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}const Fe=new i.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>Qt}),Qt="always";function Oe(t,e,n=Qt){en(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||"always"===n)&&e.valueAccessor.setDisabledState?.(t.disabled),function Jo(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Dr(t,e)})}(t,e),function Xo(t,e){const n=(r,o)=>{e.valueAccessor.writeValue(r),o&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function Ko(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Dr(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function Yo(t,e){if(e.valueAccessor.setDisabledState){const n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function ut(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function en(t,e){const n=function mr(t){return t._rawValidators}(t);null!==e.validator?t.setValidators(gr(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const r=function vr(t){return t._rawAsyncValidators}(t);null!==e.asyncValidator?t.setAsyncValidators(gr(r,e.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const o=()=>t.updateValueAndValidity();ut(e._rawValidators,o),ut(e._rawAsyncValidators,o)}function Dr(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}const rs={provide:M,useExisting:(0,i.Gpc)(()=>Ne)},Ie=(()=>Promise.resolve())();let Ne=(()=>{class t extends M{constructor(n,r,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._directives=new Set,this.ngSubmit=new i.vpe,this.form=new Xt({},$t(n),Lt(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){Ie.then(()=>{const r=this._findContainer(n.path);n.control=r.registerControl(n.name,n.control),Oe(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){Ie.then(()=>{const r=this._findContainer(n.path);r&&r.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){Ie.then(()=>{const r=this._findContainer(n.path),o=new Xt({});(function Er(t,e){en(t,e)})(o,n),r.registerControl(n.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){Ie.then(()=>{const r=this._findContainer(n.path);r&&r.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,r){Ie.then(()=>{this.form.get(n.path).setValue(r)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,function xr(t,e){t._syncPendingControls(),e.forEach(n=>{const r=n.control;"submit"===r.updateOn&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}}return t.\u0275fac=function(n){return new(n||t)(i.Y36(w,10),i.Y36(K,10),i.Y36(Fe,8))},t.\u0275dir=i.lG2({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,r){1&n&&i.NdJ("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[i._Bn([rs]),i.qOj]}),t})();function Sr(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function Fr(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const Or=class extends Mr{constructor(e=null,n,r){super(Jt(n),Kt(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),st(n)&&(n.nonNullable||n.initialValueIsDefault)&&(this.defaultValue=Fr(e)?e.value:e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Sr(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Sr(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){Fr(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},ss={provide:X,useExisting:(0,i.Gpc)(()=>dt)},Tr=(()=>Promise.resolve())();let dt=(()=>{class t extends X{constructor(n,r,o,s,a,l){super(),this._changeDetectorRef=a,this.callSetDisabledState=l,this.control=new Or,this._registered=!1,this.update=new i.vpe,this._parent=n,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=function rn(t,e){if(!e)return null;let n,r,o;return Array.isArray(e),e.forEach(s=>{s.constructor===Ee?n=s:function ts(t){return Object.getPrototypeOf(t.constructor)===oe}(s)?r=s:o=s}),o||r||n||null}(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),function nn(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Oe(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){Tr.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const r=n.isDisabled.currentValue,o=0!==r&&(0,i.D6c)(r);Tr.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?function at(t,e){return[...e.path,t]}(n,this._parent):[n]}}return t.\u0275fac=function(n){return new(n||t)(i.Y36(M,9),i.Y36(w,10),i.Y36(K,10),i.Y36(B,10),i.Y36(i.sBO,8),i.Y36(Fe,8))},t.\u0275dir=i.lG2({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[i._Bn([ss]),i.qOj,i.TTD]}),t})(),on=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=i.lG2({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const as={provide:B,useExisting:(0,i.Gpc)(()=>ht),multi:!0};let ht=(()=>{class t extends oe{writeValue(n){this.setProperty("value",n??"")}registerOnChange(n){this.onChange=r=>{n(""==r?null:parseFloat(r))}}}return t.\u0275fac=function(){let e;return function(r){return(e||(e=i.n5z(t)))(r||t)}}(),t.\u0275dir=i.lG2({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,r){1&n&&i.NdJ("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},features:[i._Bn([as]),i.qOj]}),t})(),kr=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})(),se=(()=>{class t{constructor(){this._validator=nt}ngOnChanges(n){if(this.inputName in n){const r=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):nt,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=i.lG2({type:t,features:[i.TTD]}),t})();const As={provide:w,useExisting:(0,i.Gpc)(()=>Te),multi:!0};let Te=(()=>{class t extends se{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=i.D6c,this.createValidator=n=>nr}enabled(n){return n}}return t.\u0275fac=function(){let e;return function(r){return(e||(e=i.n5z(t)))(r||t)}}(),t.\u0275dir=i.lG2({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,r){2&n&&i.uIk("required",r._enabled?"":null)},inputs:{required:"required"},features:[i._Bn([As]),i.qOj]}),t})(),Fs=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[kr]}),t})(),Qr=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:Fe,useValue:n.callSetDisabledState??Qt}]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[Fs]}),t})();function ei(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A(t,e,n){ei(t,e),e.set(t,n)}function ti(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function c(t,e){return function Ps(t,e){return e.get?e.get.call(t):e.value}(t,ti(t,e,"get"))}function v(t,e,n){return function Gs(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,ti(t,e,"set"),n),n}var Rs=f(9635),k=new WeakMap,$=new WeakMap,ft=new WeakMap,pt=new WeakMap,ke=new WeakMap,dn=new WeakMap,gt=new WeakMap,ni=new WeakSet;class Pe{constructor(e){(function Ts(t,e){ei(t,e),e.add(t)})(this,ni),A(this,k,{writable:!0,value:void 0}),A(this,$,{writable:!0,value:void 0}),A(this,ft,{writable:!0,value:void 0}),A(this,pt,{writable:!0,value:void 0}),A(this,ke,{writable:!0,value:void 0}),A(this,dn,{writable:!0,value:void 0}),A(this,gt,{writable:!0,value:void 0}),this.ref=e,v(this,$,this.ref.nativeElement),v(this,ft,{x:0,y:0,w:0,h:0}),v(this,pt,ce(c(this,$),"mouseup")),this.selectionChange=c(this,pt).pipe(Rt(ce(c(this,$),"mousedown").pipe((0,F.w)(r=>ce(c(this,$),"mousemove").pipe(Ze(c(this,pt)),function ks(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,ni,Bs).call(this,r))),(0,W.b)(r=>v(this,ft,r))),(r,o)=>o)),v(this,dn,0),v(this,gt,()=>{c(this,$).width|=0,c(this,ke).drawImage(c(this,k).img,0,0);const{x:r,y:o,w:s,h:a}=c(this,ft);c(this,ke).fillStyle="rgba(255,0,0,0.3)",c(this,ke).fillRect(r*c(this,k).gridCellSize,o*c(this,k).gridCellSize,s*c(this,k).gridCellSize,a*c(this,k).gridCellSize),v(this,dn,requestAnimationFrame(c(this,gt)))});const n=c(this,$).getContext("2d");if(!n)throw Error("Provide input canvas!");v(this,ke,n)}set config(e){v(this,k,e),c(this,$).width=e.img.width,c(this,$).height=e.img.height,c(this,gt).call(this)}}function Bs(t){return(0,Rs.z)((0,C.U)(e=>{const n=Math.trunc(t.offsetX/c(this,k).gridCellSize),r=Math.trunc(t.offsetY/c(this,k).gridCellSize);return{x:n,y:r,w:Math.trunc(e.offsetX/c(this,k).gridCellSize)-n+1,h:Math.trunc(e.offsetY/c(this,k).gridCellSize)-r+1}}))}function Us(t,e){if(1&t){const n=i.EpF();i.TgZ(0,"canvas",7),i.NdJ("selectionChange",function(o){i.CHM(n);const s=i.oxw();return i.KtG(s.selectionChange.next(o))}),i.qZA()}2&t&&i.Q6J("config",e.rxIf)}Pe.\u0275fac=function(e){return new(e||Pe)(i.Y36(i.SBq))},Pe.\u0275dir=i.lG2({type:Pe,selectors:[["canvas","input","","config",""]],inputs:{config:"config"},outputs:{selectionChange:"selectionChange"},standalone:!0});class Ge{constructor(){this.form=new he,this.configChange=this.form.pipe((0,F.w)(({file:e,gridCellSize:n})=>((t,e=new FileReader)=>new E.y(n=>{e.onload=({target:r})=>"string"==typeof r?.result&&n.next(r.result),e.readAsDataURL(t)}))(e).pipe((0,F.w)(r=>((t,e=new Image)=>new E.y(n=>{e.onload=()=>n.next(e),e.src=t}))(r)),(0,C.U)(r=>({gridCellSize:n,img:r}))))),this.selectionChange=new de.x}submit({gridCellSize:e},n){this.form.next({file:n,gridCellSize:e})}}Ge.\u0275fac=function(e){return new(e||Ge)},Ge.\u0275cmp=i.Xpm({type:Ge,selectors:[["app-img-input"]],outputs:{configChange:"configChange",selectionChange:"selectionChange"},standalone:!0,features:[i.jDz],decls:9,vars:2,consts:[[3,"ngSubmit"],["form","ngForm"],["name","tileset","ngModel","","placeholder","Tileset file","required","","type","file"],["tileset",""],["name","gridCellSize","ngModel","","placeholder","Grid cell size","required","","type","number"],["type","submit",3,"disabled"],["input","",3,"config","selectionChange",4,"rxIf"],["input","",3,"config","selectionChange"]],template:function(e,n){if(1&e){const r=i.EpF();i.TgZ(0,"h2"),i._uU(1,"Img input"),i.qZA(),i.TgZ(2,"form",0,1),i.NdJ("ngSubmit",function(){i.CHM(r);const s=i.MAs(3),a=i.MAs(5);return i.KtG(n.submit(s.value,null==a.files?null:a.files[0]))}),i._UZ(4,"input",2,3)(6,"input",4)(7,"input",5),i.qZA(),i.YNc(8,Us,1,1,"canvas",6)}if(2&e){const r=i.MAs(3);i.xp6(7),i.Q6J("disabled",r.invalid),i.xp6(1),i.Q6J("rxIf",n.configChange)}},dependencies:[Pe,Qr,on,Ee,ht,qt,Wt,Te,dt,Ne,Ut,Bt],encapsulation:2,changeDetection:0});const Hs=N("Promise"),mt={setInterval(t,e,...n){const{delegate:r}=mt;return r?.setInterval?r.setInterval(t,e,...n):function $s(t,e=0){return N("setInterval")(t,e)}(t,e)},clearInterval(t){const{delegate:e}=mt;return(e?.clearInterval||clearInterval)(t)}};class Ls extends fe.w0{constructor(e,n){super()}schedule(e,n=0){return this}}class vt extends Ls{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){if(this.closed)return this;this.state=e;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(o,this.id,n),this}requestAsyncId(e,n,r=0){return mt.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return n;mt.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let o,r=!1;try{this.work(e)}catch(s){r=!0,o=!!s&&s||new Error(s)}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:r}=n;if(this.work=this.state=this.scheduler=null,this.pending=!1,r){const o=r.indexOf(this);0<=o&&r.splice(o,1)}null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}}const ri={now:()=>(ri.delegate||Date).now()};class Re{constructor(e,n=Re.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}}Re.now=ri.now;class _t extends Re{constructor(e,n=Re.now){super(e,n),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}}new _t(vt);const zs=Array.isArray;function pn(t,e,n,r){return(t=>"function"==typeof t)(n)&&(r=n,n=void 0),r?pn(t,e,n).pipe((0,C.U)(o=>zs(o)?r(...o):r(o))):new E.y(o=>{oi(t,e,function s(a){o.next(arguments.length>1?Array.prototype.slice.call(arguments):a)},o,n)})}function oi(t,e,n,r,o){let s;if(function Js(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const a=t;N(t,"addEventListener").call(t,e,n,o),s=()=>N(a,"removeEventListener").call(a,e,n,o)}else if(function Ys(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const a=t;t.on(e,n),s=()=>a.off(e,n)}else if(function Zs(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const a=t;t.addListener(e,n),s=()=>a.removeListener(e,n)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let a=0,l=t.length;a<l;a++)oi(t[a],e,n,r,o)}r.add(s)}let gn,Ks=1;const mn={};function si(t){return t in mn&&(delete mn[t],!0)}const Xs={setImmediate(t){const e=Ks++;return mn[e]=!0,gn||(gn=Hs.resolve()),gn.then(()=>si(e)&&t()),e},clearImmediate(t){si(t)}},{setImmediate:Qs,clearImmediate:ea}=Xs,yt={setImmediate(...t){const{delegate:e}=yt;return(e?.setImmediate||Qs)(...t)},clearImmediate(t){const{delegate:e}=yt;return(e?.clearImmediate||ea)(t)}};new class na extends _t{flush(e){this._active=!0;const n=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let o;e=e||r.shift();do{if(o=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===n&&r.shift());if(this._active=!1,o){for(;(e=r[0])&&e.id===n&&r.shift();)e.unsubscribe();throw o}}}(class ta extends vt{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}requestAsyncId(e,n,r=0){return null!==r&&r>0?super.requestAsyncId(e,n,r):(e.actions.push(this),e._scheduled||(e._scheduled=yt.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,n,r=0){if(null!==r&&r>0||null===r&&this.delay>0)return super.recycleAsyncId(e,n,r);e.actions.some(o=>o.id===n)||(yt.clearImmediate(n),e._scheduled=void 0)}}),new class ia extends _t{}(class ra extends vt{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return null!==r&&r>0||null===r&&this.delay>0?super.requestAsyncId(e,n,r):e.flush(this)}});const ai=N("cancelAnimationFrame"),li=N("requestAnimationFrame"),Be={schedule(t){let e=li,n=ai;const{delegate:r}=Be;r&&(e=r.requestAnimationFrame,n=r.cancelAnimationFrame);const o=e(s=>{n=void 0,t(s)});return new fe.w0(()=>n?.(o))},requestAnimationFrame(...t){const{delegate:e}=Be;return(e?.requestAnimationFrame||li)(...t)},cancelAnimationFrame(...t){const{delegate:e}=Be;return(e?.cancelAnimationFrame||ai)(...t)}};new class sa extends _t{flush(e){this._active=!0;const n=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let o;e=e||r.shift();do{if(o=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===n&&r.shift());if(this._active=!1,o){for(;(e=r[0])&&e.id===n&&r.shift();)e.unsubscribe();throw o}}}(class oa extends vt{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}requestAsyncId(e,n,r=0){return null!==r&&r>0?super.requestAsyncId(e,n,r):(e.actions.push(this),e._scheduled||(e._scheduled=Be.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,n,r=0){if(null!=r&&r>0||null==r&&this.delay>0)return super.recycleAsyncId(e,n,r);e.actions.some(o=>o.id===n)||(Be.cancelAnimationFrame(n),e._scheduled=void 0)}});var Q=new WeakMap,Ct=new WeakMap,U=new WeakMap,Vt=new WeakMap,Ue=new WeakMap,me=new WeakMap,ve=new WeakMap,He=new WeakMap,bt=new WeakMap;class $e{constructor(e){A(this,Q,{writable:!0,value:void 0}),A(this,Ct,{writable:!0,value:void 0}),A(this,U,{writable:!0,value:void 0}),A(this,Vt,{writable:!0,value:void 0}),A(this,Ue,{writable:!0,value:void 0}),A(this,me,{writable:!0,value:void 0}),A(this,ve,{writable:!0,value:void 0}),A(this,He,{writable:!0,value:void 0}),A(this,bt,{writable:!0,value:void 0}),this.ref=e,v(this,Q,this.ref.nativeElement),v(this,Vt,0),v(this,Ue,{}),v(this,ve,new de.x),v(this,He,!0),v(this,bt,()=>{const{inputGridCellSize:o,outputGridCellSize:s,selection:a}=c(this,U);c(this,Q).width|=0,c(this,me)&&c(this,Ct).drawImage(c(this,U).img,a.x*o,a.y*o,a.w*o,a.h*o,c(this,me).x*s,c(this,me).y*s,a.w*s,a.h*s);for(const l in c(this,Ue)){const u=c(this,Ue)[l];c(this,Ct).drawImage(c(this,U).img,u.x*o,u.y*o,u.w*o,u.h*o,u.offset.x*s,u.offset.y*s,u.w*s,u.h*s)}v(this,Vt,requestAnimationFrame(c(this,bt)))});const n=c(this,Q).getContext("2d");if(!n)throw Error("Provide output canvas!");n.imageSmoothingEnabled=!1,n.imageSmoothingQuality="high",v(this,Ct,n);const r=pn(c(this,Q),"click");pn(c(this,Q),"mousemove").pipe(Ze(c(this,ve)),(0,ye.h)(()=>c(this,He))).subscribe(o=>{v(this,me,{x:Math.trunc(o.offsetX/c(this,U).outputGridCellSize),y:Math.trunc(o.offsetY/c(this,U).outputGridCellSize)})}),r.pipe(Ze(c(this,ve))).subscribe(o=>{const{x:s,y:a,w:l,h:u}=c(this,U).selection,p={x:Math.trunc(o.offsetX/c(this,U).outputGridCellSize),y:Math.trunc(o.offsetY/c(this,U).outputGridCellSize)};c(this,Ue)[`${s}${a}${l}${u}`]={x:s,y:a,w:l,h:u,offset:p},v(this,me,void 0),v(this,He,!1)})}set config(e){v(this,U,e),c(this,Q).width=e.width*e.outputGridCellSize,c(this,Q).height=e.height*e.outputGridCellSize,v(this,He,!0),c(this,bt).call(this)}ngOnDestroy(){cancelAnimationFrame(c(this,Vt)),c(this,ve).next(),c(this,ve).complete()}}function la(t,e){if(1&t&&i._UZ(0,"canvas",7),2&t){const n=i.oxw();i.Q6J("config",n.mergedConfig)}}$e.\u0275fac=function(e){return new(e||$e)(i.Y36(i.SBq))},$e.\u0275dir=i.lG2({type:$e,selectors:[["canvas","output","","config",""]],inputs:{config:"config"},standalone:!0});class Le{constructor(){this.configChange=new de.x}}Le.\u0275fac=function(e){return new(e||Le)},Le.\u0275cmp=i.Xpm({type:Le,selectors:[["app-img-output","mergedConfig",""]],inputs:{mergedConfig:"mergedConfig"},outputs:{configChange:"configChange"},standalone:!0,features:[i.jDz],attrs:["mergedConfig",""],decls:9,vars:2,consts:[[3,"ngSubmit"],["form","ngForm"],["name","gridCellSize","ngModel","","placeholder","Grid cell size","required","","type","number"],["name","width","ngModel","","placeholder","Width","required","","type","number"],["name","height","ngModel","","placeholder","Height","required","","type","number"],["type","submit",3,"disabled"],["output","",3,"config",4,"rxIf"],["output","",3,"config"]],template:function(e,n){if(1&e){const r=i.EpF();i.TgZ(0,"h2"),i._uU(1,"Img output"),i.qZA(),i.TgZ(2,"form",0,1),i.NdJ("ngSubmit",function(){i.CHM(r);const s=i.MAs(3);return i.KtG(n.configChange.next(s.value))}),i._UZ(4,"input",2)(5,"input",3)(6,"input",4)(7,"input",5),i.qZA(),i.YNc(8,la,1,1,"canvas",6)}if(2&e){const r=i.MAs(3);i.xp6(7),i.Q6J("disabled",r.invalid),i.xp6(1),i.Q6J("rxIf",n.mergedConfig)}},dependencies:[$e,Qr,on,Ee,ht,qt,Wt,Te,dt,Ne,Ut,Bt],encapsulation:2,changeDetection:0});class je{constructor(e){this.service=e}}je.\u0275fac=function(e){return new(e||je)(i.Y36(So.Y))},je.\u0275cmp=i.Xpm({type:je,selectors:[["ng-component"]],standalone:!0,features:[i.jDz],decls:3,vars:3,consts:[[3,"configChange","selectionChange"],[3,"mergedConfig","configChange"]],template:function(e,n){1&e&&(i.TgZ(0,"app-img-input",0),i.NdJ("configChange",function(o){return n.service.inputConfig.next(o)})("selectionChange",function(o){return n.service.selection.next(o)}),i.qZA(),i.TgZ(1,"app-img-output",1),i.NdJ("configChange",function(o){return n.service.outputConfig.next(o)}),i.ALo(2,"push"),i.qZA()),2&e&&(i.xp6(1),i.Q6J("mergedConfig",i.lcZ(2,1,n.service.mergedConfig$)))},dependencies:[Ge,Le,xo,Mo,Ut],encapsulation:2,changeDetection:0})}}]);